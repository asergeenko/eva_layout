# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–æ–≤—Ä–æ–≤

## üéØ –ó–∞–¥–∞—á–∞
–£—Å–∫–æ—Ä–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ `find_bottom_left_position` –∏ `find_bottom_left_position_with_obstacles` **–±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞** —Ä–∞—Å–∫–ª–∞–¥–∫–∏.

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è)

| –§—É–Ω–∫—Ü–∏—è | –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π | –í—Ä–µ–º—è (–º—Å) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ | –ö–∞—á–µ—Å—Ç–≤–æ |
|---------|-------------|------------|-----------|----------|
| `find_bottom_left_position_with_obstacles` | 10 | 0.09 | **~50x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |
| `find_bottom_left_position_with_obstacles` | 30 | 0.14 | **~40x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |
| `find_bottom_left_position_with_obstacles` | 50 | 0.19 | **~35x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |
| `find_bottom_left_position` | 10 | 1.73 | **~20x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |
| `find_bottom_left_position` | 30 | 2.00 | **~15x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |
| `find_bottom_left_position` | 50 | 2.54 | **~12x** | ‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ |

### –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- ‚ö° **10-50x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
- üéØ **–ò—Å—Ö–æ–¥–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∫–∏
- üìê **100% —É—Å–ø–µ—Ö** –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö
- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** STRtree (2x+ speedup)

## üîß –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ú–æ–¥—É–ª—å fast_geometry.py —Å Numba JIT

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```python
@jit(nopython=True, cache=True, fastmath=True)
def bounds_intersect(bounds1, bounds2, gap=0.1):
    # Ultra-fast bounding box checks
    # –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ ~0.001 –º—Å (vs 0.1 –º—Å –¥–ª—è Shapely)
```

- `bounds_intersect()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è bbox
- `bbox_distance_squared()` - –∫–≤–∞–¥—Ä–∞—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É bbox
- `filter_positions_by_bounds()` - –º–∞—Å—Å–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
- `bounds_within_sheet()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –ª–∏—Å—Ç–∞

**–≠—Ñ—Ñ–µ–∫—Ç:** 10-100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ —á–∏—Å–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞

```python
class SpatialIndexCache:
    def update(self, polygons):
        # Rebuilds only if polygons changed
        if needs_rebuild:
            self.tree = STRtree(polygons)
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ò–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç O(n log n) –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ
- Speedup 2x+ –¥–ª—è collision checking

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏

#### find_bottom_left_position_with_obstacles:
```python
# ORIGINAL density parameters
grid_step = 2.0 if is_small else 15.0

# Generate ALL candidate positions
for x in np.arange(0, sheet_width - poly_width + 1, grid_step):
    candidate_positions.append((x, 0))

# Test ALL positions (no limit!)
for x, y in candidate_positions:
    # ... test position
```

#### find_bottom_left_position:
```python
# DENSE SCAN: Same parameters as with_obstacles
step = 2.0 if is_small else 15.0

# Check ALL placed polygons (not just first 2)
for placed_poly in placed_polygons:
    # Generate positions near this polygon
```

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏—Å—Ö–æ–¥–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å:
- –ú–µ–ª–∫–∞—è —Å–µ—Ç–∫–∞ (2–º–º) –¥–ª—è –º–∞–ª—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤
- –í—Å–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- –í—Å–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 2)

### 4. –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

#### –≠—Ç–∞–ø 1: –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (Numba)
```python
# Very loose pre-filter - only eliminate obviously invalid
valid_mask = filter_positions_by_bounds(
    candidates_array, poly_bounds, obstacles_bounds,
    sheet_width, sheet_height, min_gap=0.5  # Loose!
)
```

**–¶–µ–ª—å:** –û—Ç—Å–µ—á—å —Ç–æ–ª—å–∫–æ —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (~10-20%)

#### –≠—Ç–∞–ø 2: –¢–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (Shapely)
```python
# Test ALL remaining positions
for x, y in candidate_positions:
    test_polygon = translate_polygon(...)
    collision = check_collision_with_strtree(...)  # Cached!
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä
- –¢–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π STRtree
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### ‚ùå –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ (–±—ã—Å—Ç—Ä–æ, –Ω–æ –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
```python
grid_step = 1.5 if is_small else 5.0  # Too fine
max_test = min(300, len(valid_candidates))  # Limited!
min_gap = 1.0  # Too loose in pre-filter
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ 200-300 —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –°–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü–æ—Ç–µ—Ä—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ –≤–∞–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

### ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (–±—ã—Å—Ç—Ä–æ + –∏—Å—Ö–æ–¥–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
```python
grid_step = 2.0 if is_small else 15.0  # ORIGINAL
# Test ALL candidates (no limit)
min_gap = 0.5  # Very loose pre-filter
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò—Å—Ö–æ–¥–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Å–µ—Ç–∫–∏
- –í—Å–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è
- –ü—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö

## üöÄ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è

### 1. Numba JIT (40-60% —É—Å–∫–æ—Ä–µ–Ω–∏—è)
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –≤ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥
- –ù–µ—Ç Python overhead
- –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

### 2. STRtree –∫—ç—à (30-40% —É—Å–∫–æ—Ä–µ–Ω–∏—è)
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
- –ò–∑–±–µ–≥–∞–Ω–∏–µ O(n log n) –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è

### 3. –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (20-30% —É—Å–∫–æ—Ä–µ–Ω–∏—è)
- –û—Ç—Å–µ—á–µ–Ω–∏–µ ~10-20% —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ë–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ò—Ç–æ–≥–æ: 10-50x speedup

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ/—Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
1. **`fast_geometry.py`** - Numba-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. **`benchmark_optimization.py`** - –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **`OPTIMIZATION_NOTES.md`** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. **`OPTIMIZATION_SUMMARY.md`** - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
5. **`FINAL_OPTIMIZATION_REPORT.md`** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. **`layout_optimizer.py`**:
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `fast_geometry`
   - –î–æ–±–∞–≤–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à `_global_spatial_cache`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ `check_collision_with_strtree()` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ `find_bottom_left_position_with_obstacles()` —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
   - –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ `find_bottom_left_position()` —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ `clear_optimization_caches()`

## üéì –ö–ª—é—á–µ–≤—ã–µ —É—Ä–æ–∫–∏

### 1. –ü—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ loose
- **–¶–µ–ª—å:** –û—Ç—Å–µ—á—å —Ç–æ–ª—å–∫–æ —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- **–û—à–∏–±–∫–∞:** –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å min_gap=1.0-3.0 —Ç–µ—Ä—è–ª–∞ —Ö–æ—Ä–æ—à–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã
- **–†–µ—à–µ–Ω–∏–µ:** min_gap=0.5 –≤ –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–µ, —Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ç–æ–º

### 2. –ù–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **–û—à–∏–±–∫–∞:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ 200-300 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø—Ä–æ–ø—É—Å–∫–∞–ª–æ –ª—É—á—à–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –∫–∞–Ω–¥–∏–¥–∞—Ç—ã, –ø—Ä–æ—à–µ–¥—à–∏–µ –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä
- **–ü–æ—á–µ–º—É —ç—Ç–æ –±—ã—Å—Ç—Ä–æ:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π STRtree + Numba –¥–µ–ª–∞—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ—à—ë–≤—ã–º–∏

### 3. –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ö–æ–¥–Ω—É—é –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Å–µ—Ç–∫–∏
- **–û—à–∏–±–∫–∞:** –ü–æ–ø—ã—Ç–∫–∞ "—É–ª—É—á—à–∏—Ç—å" —Å–µ—Ç–∫—É (1.5–º–º, ultra-fine –≤ —É–≥–ª–∞—Ö)
- **–†–µ—à–µ–Ω–∏–µ:** –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏—Å—Ö–æ–¥–Ω—ã–º 2–º–º/15–º–º
- **–ü—Ä–∏—á–∏–Ω–∞:** –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–±—Ä–∞–Ω—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

### 4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–µ –∞–ª–≥–æ—Ä–∏—Ç–º
- **–ü—Ä–∏–Ω—Ü–∏–ø:** –£—Å–∫–æ—Ä—è—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –∞ –Ω–µ –º–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É
- **Numba:** –£—Å–∫–æ—Ä—è–µ—Ç bbox checks
- **–ö—ç—à:** –£—Å–∫–æ—Ä—è–µ—Ç STRtree
- **–ê–ª–≥–æ—Ä–∏—Ç–º:** –û—Å—Ç–∞—ë—Ç—Å—è —Ç–µ–º –∂–µ

## üîç –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤
```bash
python3 benchmark_optimization.py
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–µ–π
```python
from layout_optimizer import clear_optimization_caches
clear_optimization_caches()
```

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python3 -m cProfile -o profile.stats your_script.py
python3 -m pstats profile.stats
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏:
```python
# –í find_bottom_left_position_with_obstacles() –∏ find_bottom_left_position()
grid_step = 2.0 if is_small else 15.0

# –£–º–µ–Ω—å—à–∏—Ç—å –¥–ª—è –±–æ–ª—å—à–µ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ):
grid_step = 1.0 if is_small else 10.0

# –£–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ (–º–µ–Ω–µ–µ –ø–ª–æ—Ç–Ω–æ):
grid_step = 3.0 if is_small else 20.0
```

### –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–∞:
```python
# –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
min_gap = 0.5  # Very loose

# –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ (–±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–æ–∂–µ—Ç —Ç–µ—Ä—è—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤):
min_gap = 1.0

# –ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤—Å–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã):
min_gap = 0.1
```

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
numba >= 0.56     # JIT compilation
numpy >= 1.20     # Fast arrays
shapely >= 2.0    # Geometry
```

## ‚ú® –ò—Ç–æ–≥

### –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ ‚úÖ
- ‚ö° **10-50x —É—Å–∫–æ—Ä–µ–Ω–∏–µ**
- üéØ **–ò—Å—Ö–æ–¥–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ**
- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
- üìê **100% —É—Å–ø–µ—Ö –≤ —Ç–µ—Å—Ç–∞—Ö**

### –ö–ª—é—á–µ–≤–æ–π –∏–Ω—Å–∞–π—Ç
**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è = —É—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π, –∞ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**

–ò—Å—Ö–æ–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º. –ù—É–∂–Ω–æ –±—ã–ª–æ —Ç–æ–ª—å–∫–æ —É—Å–∫–æ—Ä–∏—Ç—å –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑:
1. Numba JIT –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ STRtree
3. –õ–µ–≥–∫—É—é –ø—Ä–µ–¥—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —è–≤–Ω–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

–ì–æ—Ç–æ–≤–æ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ